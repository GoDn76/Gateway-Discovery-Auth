# -----------------------------------------------------------------
# SERVICE PORT & NAME
# -------------------A----------------------------------------------
server:
  port: 8080
  forward-headers-strategy: framework

spring:
  # -----------------------------------------------------------------
  # DATABASE (POSTGRESQL) & JPA CONFIGURATION
  # -----------------------------------------------------------------
  datasource:
    url: ${DB_URL} #
    username: ${DB_USERNAME} # Your Postgres username
    password: ${DB_PASSWORD}
    hikari:
      data-source-properties:
        prepareThreshold: 0
    driver-class-name: org.postgresql.Driver
  jpa:
    hibernate:
      ddl-auto: update # Automatically updates the schema. Good for development.
    show-sql: true # Lets you see the generated SQL queries in the console
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect

# -----------------------------------------------------------------
# EMAIL SENDER CONFIGURATION (Example using Gmail)
# -----------------------------------------------------------------
  mail:
    host: smtp-relay.brevo.com
    port: 587
    username: ${MAIL_USERNAME}
    password: ${MAIL_PASSWORD}
    from: ${SENDER_EMAIL}
    properties:
      mail:
        smtp:
          auth: true
          starttls:
            enable: true

  security:
    oauth2:
          client:
            registration:
              google:
                client-id: ${GOOGLE_CLIENT_ID}
                client-secret: ${GOOGLE_CLIENT_SECRET}
                scope:
                  - email
                  - profile
  application:
    name: user-service

# -----------------------------------------------------------------
# EUREKA CLIENT CONFIGURATION
# -----------------------------------------------------------------

eureka:
  client:
    service-url:
      defaultZone: http://godn-gw.duckdns.org:8761/eureka/
  instance:
    hostname: ${CONTAINER_APP_HOSTNAME:localhost}
      # If on Azure (variable exists), use HTTPS/443. If local, use HTTP/8080.
    non-secure-port-enabled: ${IS_LOCAL:true}
    secure-port-enabled: ${IS_CLOUD:false}
    secure-port: 443
    non-secure-port: 8080
    instance-id: ${spring.application.name}:${spring.application.instance_id:${random.value}}


  # -----------------------------------------------------------------
  # APPLICATION-SPECIFIC PROPERTIES (FOR JWT)
  # -----------------------------------------------------------------
app: # <-- âœ… CORRECT: Top level, aligned with spring, server, etc.
  jwt:
    secret: ${JWT_SECRET}
    expiration-ms: 86400000

springdoc:
  api-docs:
    path: /v3/api-docs
  swagger-ui:
    # This tells Swagger: "When you look for config, look RELATIVE to the current path"
    configUrl: /users/v3/api-docs/swagger-config
    url: /users/v3/api-docs
    disable-swagger-default-url: true

name:
  application: ${APP_NAME}